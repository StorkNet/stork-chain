// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "./StorkTypes.sol";

contract StorkDataStore is StorkTypes {
    modifier IsOnlyStorkBlockGenerator() {
        require(
            msg.sender == storkBlockGeneratorAddress,
            "is not stork block generator"
        );
        _;
    }

    address public storkBlockGeneratorAddress;
    mapping(address => mapping(bytes32 => mapping(uint8 => bytes)))
        public dataStore;
    mapping(address => mapping(bytes32 => bytes)) public phalanx;

    function setStorkBlockGeneratorAddress(address _storkBlockGeneratorAddress)
        public
    {
        require(
            storkBlockGeneratorAddress != address(0),
            "stork block generator already set"
        );
        storkBlockGeneratorAddress = _storkBlockGeneratorAddress;
    }

    function createNewPhalanx(
        address _addr,
        bytes32 _phalanxName,
        bytes calldata _phalanxData
    ) public {
        phalanx[_addr][_phalanxName] = _phalanxData;
    }

    function createNewData(
        address _addr,
        bytes32 _phalanxName,
        uint8 _storkId,
        bytes calldata _storkData
    ) public {
        dataStore[_addr][_phalanxName][_storkId] = _storkData;
    }

    function readData(
        address _addr,
        bytes32 _phalanxName,
        uint8 _storkId
    ) public view returns (bytes memory) {
        return (dataStore[_addr][_phalanxName][_storkId]);
    }

    function deleteData(
        address _addr,
        bytes32 _phalanxName,
        uint8 _storkId
    ) public {
        delete dataStore[_addr][_phalanxName][_storkId];
    }
}

// create phalanx
// 0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000003a000000000000000000000000000000000000000000000000000000000000004a0000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000006737472696e67000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000046e616d65000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000000575696e7438000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000567726164650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000000775696e74385b5d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000673636f72657300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000004626f6f6c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a63616e50726f6d6f7465000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000004626f6f6c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b69734576616c75617465640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

// student 1
// 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000900000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000372616d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000050

// student 2
// 0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000b00000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000862656e6a616d696e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000050
