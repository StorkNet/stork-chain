// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "./StorkTypes.sol";

contract StorkDataStore is StorkTypes {
    modifier IsOnlyStorkBlockGenerator() {
        require(
            msg.sender == storkBlockGeneratorAddress,
            "is not stork block generator"
        );
        _;
    }

    address internal storkBlockGeneratorAddress;
    mapping(address => mapping(bytes32 => mapping(uint8 => bytes)))
        internal dataStore;
    mapping(address => mapping(bytes32 => bytes)) public phalanx;

    function setStorkBlockGeneratorAddress(address _storkBlockGeneratorAddress)
        public
    {
        require(
            storkBlockGeneratorAddress != address(0),
            "stork block generator already set"
        );
        storkBlockGeneratorAddress = _storkBlockGeneratorAddress;
    }

    function createNewPhalanx(
        address _addr,
        bytes32 _phalanxName,
        bytes calldata _phalanxData
    ) public {
        phalanx[_addr][_phalanxName] = _phalanxData;
    }

    function createNewData(
        address _addr,
        bytes32 _phalanxName,
        uint8 _storkId,
        bytes calldata _storkData
    ) public {
        dataStore[_addr][_phalanxName][_storkId] = _storkData;
    }

    function readData(
        address _addr,
        bytes32 _phalanxName,
        uint8 _storkId
    ) public view returns (bytes memory) {
        return (dataStore[_addr][_phalanxName][_storkId]);
    }

    function deleteData(
        address _addr,
        bytes32 _phalanxName,
        uint8 _storkId
    ) public {
        delete dataStore[_addr][_phalanxName][_storkId];
    }
}

// createPhalanxType
// 0xa3f53525905c799d5c88889bbe93edd7d233a2b792e3ca3a5cfdb0446e700c29

// createStork
// 0x64dd0ad78017a5999eca08b47c09269b0e0bfd854cd31d5c69ffd37076da2267

// student
// 0x51e8ccf16b7d0bf6dbff3704faa1cc765b8473004eafd29e94bfe47167ff5e93

// createPhalaxType
// 0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000003a000000000000000000000000000000000000000000000000000000000000004a0000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000006737472696e67000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000046e616d65000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000000575696e7438000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000567726164650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000000775696e74385b5d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000673636f72657300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000004626f6f6c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a63616e50726f6d6f7465000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000004626f6f6c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b69734576616c75617465640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

// createStork
// 0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000001f7368616e6b617200000000000000000000000000000000000000000000000000

// createStork
// 0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000001f7368616e6b617200000000000000000000000000000000000000000000000000
